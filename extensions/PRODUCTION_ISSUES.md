# üîç –ü—Ä–æ–±–ª–µ–º—ã –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Math.max –¥–ª—è –±–∞–ª–∞–Ω—Å–∞**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/changePointsToItem.tsx:95`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `setBalance((prev) => prev - reward.pointsCost);` –º–æ–∂–µ—Ç —É–π—Ç–∏ –≤ –º–∏–Ω—É—Å
- **–†–µ—à–µ–Ω–∏–µ**: `setBalance((prev) => Math.max(0, prev - reward.pointsCost));`

### 4. **–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ JSON**

- **–§–∞–π–ª—ã**: –í—Å–µ —Ñ–∞–π–ª—ã —Å JSON.parse
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –ø–∞—Ä—Å–∏–Ω–≥–æ–º
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ –ø–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 5. **@ts-nocheck –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–æ–≤**

- **–§–∞–π–ª—ã**:
  - `extensions/checkout-ui/src/Checkout.jsx:1`
  - `extensions/checkout-ui/src/validateSystem.tsx:1`
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç–∫–ª—é—á–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ TypeScript
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–∏–ø—ã –≤–º–µ—Å—Ç–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 6. **@ts-ignore –≤ discount function**

- **–§–∞–π–ª**: `extensions/discount-function/src/cart_lines_discounts_generate_run.ts:31,76`
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞—Ç—å `input.cart.freeItemsAttr` –∏ `input.cart.pointsToRedeemAttr`

### 7. **–†—É—Å—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ**

- **–§–∞–π–ª**: `extensions/loyalty-reward-guard/blocks/loyalty-guard.liquid:16,33,43,49,60,74,104,119,134`
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –≤ –∫–æ–¥–µ
- **–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –¥–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã

### 8. **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/utils.ts:17-30`
- **–ü—Ä–æ–±–ª–µ–º–∞**: –§—É–Ω–∫—Ü–∏–∏ `changePointsToMoney` –∏ `cancelPointsRedemption` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ç–æ–ª—å–∫–æ boolean, –±–µ–∑ –¥–µ—Ç–∞–ª–µ–π –æ–± –æ—à–∏–±–∫–µ
- **–†–µ—à–µ–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–±—ä–µ–∫—Ç —Å –¥–µ—Ç–∞–ª—è–º–∏ –æ—à–∏–±–∫–∏

### 9. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏—è**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/utils.ts:27`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `return (status = false);` - –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—Ç–∞
- **–†–µ—à–µ–Ω–∏–µ**: `return false;` –∏–ª–∏ `status = false; return status;`

### 10. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

- **–§–∞–π–ª—ã**: –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ utils.ts
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ null/undefined

## üîß –£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 11. **–ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ useMemo/useEffect**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/validateSystem.tsx:91`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `useMemo` –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `allAttributes` (–º–∞—Å—Å–∏–≤), –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç—Å—è
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ useMemo –¥–ª—è cartAttributes

### 12. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/Checkout.jsx:49`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `getBalanceFromMetafields(useAppMetafields)` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å useMemo

## üåê –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

### 13. **–ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/changePointsToItem.tsx:168`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `"Redeem"` –Ω–µ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `shopify.i18n.translate()`

### 14. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ error messages**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/validateSystem.tsx:102,107`
- **–ü—Ä–æ–±–ª–µ–º–∞**: Fallback —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º, –Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 15. **–ù–µ—Ç —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö**

- **–§–∞–π–ª—ã**: –í—Å–µ –º–µ—Å—Ç–∞ —Å JSON.parse
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ XSS/–∏–Ω—ä–µ–∫—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ**: –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

### 16. **–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ localStorage**

- **–§–∞–π–ª**: `extensions/loyalty-reward-guard/blocks/loyalty-guard.liquid`
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å localStorage
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 17. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤**

- **–ü—Ä–æ–±–ª–µ–º–∞**: –§—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å JSDoc –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

## üé® UX/UI

### 18. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ loading —Å–æ—Å—Ç–æ—è–Ω–∏–π**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/utils.ts` (fetchRewardProducts)
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Ç–æ–≤–∞—Ä–æ–≤
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å loading state

### 19. **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

- **–§–∞–π–ª—ã**: –í—Å–µ async —Ñ—É–Ω–∫—Ü–∏–∏
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å user-friendly —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 20. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –≤ –º–∞—Å—Å–∏–≤–∞—Ö**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/validateSystem.tsx:73`
- **–ü—Ä–æ–±–ª–µ–º–∞**: `freeItemsVariantIds.includes()` - O(n) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Set –¥–ª—è O(1) –ø–æ–∏—Å–∫–∞

### 21. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ JSON.parse**

- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–∏—Ö –∏ —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- **–†–µ—à–µ–Ω–∏–µ**: –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞

## üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### 22. **Race conditions**

- **–§–∞–π–ª**: `extensions/checkout-ui/src/utils.ts:validatePointsBalance`
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- **–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥–∏ –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### 23. **–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö**

- **–ü—Ä–æ–±–ª–µ–º–∞**: –î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ timestamps
